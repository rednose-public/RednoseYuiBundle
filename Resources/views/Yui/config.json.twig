{% autoescape %}
{
    {# Basic settings #}
    {% if local == true %}
        "ignoreRegistered": true,
    {% else %}
        "allowRollup": true,
        "fetchCSS": true,
    {% endif %}

    {# Base URL #}
    {% if local == true %}
        "base": "{{ base }}cdn/yui3/build/",
    {% else %}
        "base": "{{ app.request.getBaseURL|replace({'/app_dev.php': ''}) }}/cdn/yui3/build/",
    {% endif %}

    {% if local == false %}
        {# Debug settings #}
        "debug": false,

        {# Combo loader URL #}
        "comboBase": "{{ app.request.getBaseURL|replace({'/app_dev.php': ''}) }}/cdn/combo?",

        {# Maximum url length based on the HTTP/1.1 RFC, should decrease the amount of GET requests. #}
        "maxURLLength" : 8177,

        {# Combo loader root #}
        "root": "cdn/yui3/build/",

        {# Combine and filter settings #}
        {% if app.environment == 'dev' %}
            "combine": false,
            "filter": "raw",
        {% else %}
            "combine": true,
        {% endif %}
    {% endif %}

    {# Group configuration settings #}
    "groups": {
        {# Gallery configuration #}
        "gallery": {
            {# Base URL #}
            {% if local == true %}
                "base": "{{ base }}cdn/yui3-gallery/build/",
            {% else %}
                "base": "{{ app.request.getBaseURL|replace({'/app_dev.php': ''}) }}/cdn/yui3-gallery/build/",
            {% endif %}

            {% if local == false %}
                {# Combo loader root #}
                "root": "cdn/yui3-gallery/build/",

                {# Maximum url length based on the HTTP/1.1 RFC, should decrease the amount of GET requests. #}
                "maxURLLength" : 8177,

                {# Combine and filter settings #}
                {% if app.environment == 'dev' %}
                    "combine": false,
                    "filter": "raw",
                {% else %}
                    "combine": true,
                {% endif %}
            {% endif %}

            {# Match by patterns, as we don't have any gallery metadata configured #}
            "patterns": {
                "gallery-": {},
                "lang/gallery-": {},
                "gallerycss-": { "type": "css" }
            }
        }

        {# Custom group configuration #}
        {% for group in groups %}
            , "{{ group.name }}": {
                {# Base URL #}
                {% if local == true %}
                    "base": "{{ base }}{{ group.root }}/build/",
                {% else %}
                    "base": "{{ app.request.getBaseURL|replace({'/app_dev.php': ''}) }}/{{ group.root }}/build/",
                {% endif %}

                {% if local == false %}
                    {# Combo loader root #}
                    "root": "{{ group.root }}/build/",

                    {# Maximum url length based on the HTTP/1.1 RFC, should decrease the amount of GET requests. #}
                    "maxURLLength" : 8177,

                    {# Combine and filter settings #}
                    {% if app.environment == 'dev' %}
                        "combine": false,
                        "debug": true,
                        "filter": "debug",
                    {% else %}
                        "combine": true,
                    {% endif %}
                {% endif %}

                {# Module metadata #}
                "modules": {{ group.metadata|raw }}
            }
        {% endfor %}
    }
}

{% endautoescape %}
